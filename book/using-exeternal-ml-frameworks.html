<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 8 Using Exeternal ML Frameworks | Predictive Modeling</title>
  <meta name="description" content="This is in support of the HERCULES Lecture Series." />
  <meta name="generator" content="bookdown 0.17 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 8 Using Exeternal ML Frameworks | Predictive Modeling" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This is in support of the HERCULES Lecture Series." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 8 Using Exeternal ML Frameworks | Predictive Modeling" />
  
  <meta name="twitter:description" content="This is in support of the HERCULES Lecture Series." />
  

<meta name="author" content="Steve Pittard" />


<meta name="date" content="2020-03-04" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="comparing-models.html"/>

<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />











<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Preditive Modeling For Imposters</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a><ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#machine-learning"><i class="fa fa-check"></i><b>1.1</b> Machine Learning</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#predictive-modeling"><i class="fa fa-check"></i><b>1.2</b> Predictive Modeling</a></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#in-sample-vs-out-of-sample-error"><i class="fa fa-check"></i><b>1.3</b> In-Sample vs Out-Of-Sample Error</a></li>
<li class="chapter" data-level="1.4" data-path="index.html"><a href="index.html#performance-metrics"><i class="fa fa-check"></i><b>1.4</b> Performance Metrics</a></li>
<li class="chapter" data-level="1.5" data-path="index.html"><a href="index.html#black-box"><i class="fa fa-check"></i><b>1.5</b> Black Box</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="getting-hands-on.html"><a href="getting-hands-on.html"><i class="fa fa-check"></i><b>2</b> Getting Hands On</a><ul>
<li class="chapter" data-level="2.1" data-path="getting-hands-on.html"><a href="getting-hands-on.html#important-terminology"><i class="fa fa-check"></i><b>2.1</b> Important Terminology</a></li>
<li class="chapter" data-level="2.2" data-path="getting-hands-on.html"><a href="getting-hands-on.html#exploratory-plots"><i class="fa fa-check"></i><b>2.2</b> Exploratory Plots</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="a-common-modeling-workflow.html"><a href="a-common-modeling-workflow.html"><i class="fa fa-check"></i><b>3</b> A Common Modeling Workflow</a><ul>
<li class="chapter" data-level="3.1" data-path="a-common-modeling-workflow.html"><a href="a-common-modeling-workflow.html#splitting-the-data"><i class="fa fa-check"></i><b>3.1</b> Splitting The Data</a></li>
<li class="chapter" data-level="3.2" data-path="a-common-modeling-workflow.html"><a href="a-common-modeling-workflow.html#first-model"><i class="fa fa-check"></i><b>3.2</b> First Model</a></li>
<li class="chapter" data-level="3.3" data-path="a-common-modeling-workflow.html"><a href="a-common-modeling-workflow.html#first-prediction"><i class="fa fa-check"></i><b>3.3</b> First Prediction</a><ul>
<li class="chapter" data-level="3.3.1" data-path="a-common-modeling-workflow.html"><a href="a-common-modeling-workflow.html#selecting-the-correct-alpha"><i class="fa fa-check"></i><b>3.3.1</b> Selecting The Correct Alpha</a></li>
<li class="chapter" data-level="3.3.2" data-path="a-common-modeling-workflow.html"><a href="a-common-modeling-workflow.html#confusion-matrices"><i class="fa fa-check"></i><b>3.3.2</b> Confusion Matrices</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="a-common-modeling-workflow.html"><a href="a-common-modeling-workflow.html#performance-measures-revisited"><i class="fa fa-check"></i><b>3.4</b> Performance Measures Revisited</a></li>
<li class="chapter" data-level="3.5" data-path="a-common-modeling-workflow.html"><a href="a-common-modeling-workflow.html#the-roc-curve"><i class="fa fa-check"></i><b>3.5</b> The ROC curve</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="other-methods.html"><a href="other-methods.html"><i class="fa fa-check"></i><b>4</b> Other Methods ?</a><ul>
<li class="chapter" data-level="4.1" data-path="other-methods.html"><a href="other-methods.html#improving-the-models"><i class="fa fa-check"></i><b>4.1</b> Improving The Model(s)</a></li>
<li class="chapter" data-level="4.2" data-path="other-methods.html"><a href="other-methods.html#cross-fold-validation"><i class="fa fa-check"></i><b>4.2</b> Cross Fold Validation</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="is-there-a-better-way.html"><a href="is-there-a-better-way.html"><i class="fa fa-check"></i><b>5</b> Is There a Better Way ?</a><ul>
<li class="chapter" data-level="5.1" data-path="is-there-a-better-way.html"><a href="is-there-a-better-way.html#data-splitting-using-caret"><i class="fa fa-check"></i><b>5.1</b> Data Splitting Using Caret</a></li>
<li class="chapter" data-level="5.2" data-path="is-there-a-better-way.html"><a href="is-there-a-better-way.html#specifying-control-options"><i class="fa fa-check"></i><b>5.2</b> Specifying Control Options</a></li>
<li class="chapter" data-level="5.3" data-path="is-there-a-better-way.html"><a href="is-there-a-better-way.html#inspecting-the-model"><i class="fa fa-check"></i><b>5.3</b> Inspecting The Model</a></li>
<li class="chapter" data-level="5.4" data-path="is-there-a-better-way.html"><a href="is-there-a-better-way.html#how-well-did-it-perform"><i class="fa fa-check"></i><b>5.4</b> How Well Did It Perform ?</a></li>
<li class="chapter" data-level="5.5" data-path="is-there-a-better-way.html"><a href="is-there-a-better-way.html#comparing-performance-across-other-methods"><i class="fa fa-check"></i><b>5.5</b> Comparing Performance Across Other Methods</a></li>
<li class="chapter" data-level="5.6" data-path="is-there-a-better-way.html"><a href="is-there-a-better-way.html#different-performance-measures"><i class="fa fa-check"></i><b>5.6</b> Different Performance Measures</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="feature-importance.html"><a href="feature-importance.html"><i class="fa fa-check"></i><b>6</b> Feature Importance</a><ul>
<li class="chapter" data-level="6.0.1" data-path="feature-importance.html"><a href="feature-importance.html#feature-elimination"><i class="fa fa-check"></i><b>6.0.1</b> Feature Elimination</a></li>
<li class="chapter" data-level="6.0.2" data-path="feature-importance.html"><a href="feature-importance.html#the-rfe-function"><i class="fa fa-check"></i><b>6.0.2</b> The rfe Function</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="comparing-models.html"><a href="comparing-models.html"><i class="fa fa-check"></i><b>7</b> Comparing Models</a></li>
<li class="chapter" data-level="8" data-path="using-exeternal-ml-frameworks.html"><a href="using-exeternal-ml-frameworks.html"><i class="fa fa-check"></i><b>8</b> Using Exeternal ML Frameworks</a><ul>
<li class="chapter" data-level="8.1" data-path="using-exeternal-ml-frameworks.html"><a href="using-exeternal-ml-frameworks.html#h2o-in-action"><i class="fa fa-check"></i><b>8.1</b> H2O In Action</a></li>
<li class="chapter" data-level="8.2" data-path="using-exeternal-ml-frameworks.html"><a href="using-exeternal-ml-frameworks.html#create-some-models"><i class="fa fa-check"></i><b>8.2</b> Create Some Models</a></li>
<li class="chapter" data-level="8.3" data-path="using-exeternal-ml-frameworks.html"><a href="using-exeternal-ml-frameworks.html#saving-a-model"><i class="fa fa-check"></i><b>8.3</b> Saving A Model</a></li>
<li class="chapter" data-level="8.4" data-path="using-exeternal-ml-frameworks.html"><a href="using-exeternal-ml-frameworks.html#using-the-auto-ml-feature"><i class="fa fa-check"></i><b>8.4</b> Using the Auto ML Feature</a></li>
<li class="chapter" data-level="8.5" data-path="using-exeternal-ml-frameworks.html"><a href="using-exeternal-ml-frameworks.html#launching-a-job"><i class="fa fa-check"></i><b>8.5</b> Launching A Job</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Predictive Modeling</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="using-exeternal-ml-frameworks" class="section level1">
<h1><span class="header-section-number">Chapter 8</span> Using Exeternal ML Frameworks</h1>
<p>There are a number of companies that provide easy access to Machine Learning services including Google, Amazon, Data Robot, and H2o. In particular, the company H20.ai provides frameworks for accessible Machine Learning by experts and non-experts. They promote the idea of “citizen data science” which seeks to lower barriers to participation in the world of AI. While they have a commercial product, they also provide an open source tool:</p>
<blockquote>
<p>H2O is a fully open source, distributed in-memory machine learning platform with linear
scalability. H2O supports the most widely used statistical &amp; machine learning algorithms
including gradient boosted machines, generalized linear models, deep learning and more.</p>
</blockquote>
<p>Moreover, H2O provides access to an “Auto ML” service that selects methods appropriate to a given data set. This is useful to help jump start ideas.</p>
<blockquote>
<p>H2O also has an industry leading AutoML functionality that automatically runs through
all the algorithms and their hyperparameters to produce a leaderboard of the best models.
The H2O platform is used by over 18,000 organizations globally and is extremely popular
in both the R &amp; Python communities.</p>
</blockquote>
<p>Better yet, there is an R package called, somewhat unimaginatively, “h2o” “which provides:</p>
<blockquote>
<p>R interface for ‘H2O’, the scalable open source machine learning platform that offers
parallelized implementations of many supervised and unsupervised machine learning algorithms
such as Generalized Linear Models, Gradient Boosting Machines (including XGBoost), Random
Forests, Deep Neural Networks (Deep Learning), Stacked Ensembles, Naive Bayes, Cox
Proportional Hazards, K-Means, PCA, Word2Vec, as well as a fully automatic machine learning
algorithm (AutoML).</p>
</blockquote>
<div id="h2o-in-action" class="section level2">
<h2><span class="header-section-number">8.1</span> H2O In Action</h2>
<p>The package must first be installed which can done using the install.packages function (or the menu in R Studio). Loading the library is done just as you would any other library.</p>
<div class="sourceCode" id="cb81"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb81-1" data-line-number="1"><span class="kw">library</span>(h2o)</a></code></pre></div>
<p>The goal of using this library is not to replace the methods available to you in R but, just like the caret package, seeks to provide a uniform interface for a variety of underlying methods. This includes common methods including an “Auto ML” service that picks methods for you. Let’s apply h2o to our work. The underlying h2o architecture uses a “running instance” concept that can be initialized and accessed from R. You initialize it once per interactive session.</p>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb82-1" data-line-number="1"><span class="kw">h2o.init</span>()</a>
<a class="sourceLine" id="cb82-2" data-line-number="2"></a>
<a class="sourceLine" id="cb82-3" data-line-number="3">H2O is not running yet, starting it now...</a>
<a class="sourceLine" id="cb82-4" data-line-number="4"></a>
<a class="sourceLine" id="cb82-5" data-line-number="5">Note<span class="op">:</span><span class="st">  </span>In case of errors look at the following log files<span class="op">:</span></a>
<a class="sourceLine" id="cb82-6" data-line-number="6"><span class="st">    </span><span class="er">/</span>var<span class="op">/</span>folders<span class="op">/</span>wh<span class="op">/</span>z0v5hqgx3dzdfgz47lnbr_3w0000gn<span class="op">/</span>T<span class="op">/</span><span class="er">/</span>RtmpRehHby<span class="op">/</span>h2o_esteban_started_from_r.out</a>
<a class="sourceLine" id="cb82-7" data-line-number="7">    <span class="op">/</span>var<span class="op">/</span>folders<span class="op">/</span>wh<span class="op">/</span>z0v5hqgx3dzdfgz47lnbr_3w0000gn<span class="op">/</span>T<span class="op">/</span><span class="er">/</span>RtmpRehHby<span class="op">/</span>h2o_esteban_started_from_r.err</a>
<a class="sourceLine" id="cb82-8" data-line-number="8"></a>
<a class="sourceLine" id="cb82-9" data-line-number="9">java version <span class="st">&quot;1.8.0_131&quot;</span></a>
<a class="sourceLine" id="cb82-10" data-line-number="10"><span class="kw">Java</span>(TM) SE Runtime <span class="kw">Environment</span> (build <span class="dv">1</span>.<span class="fl">8.0</span>_<span class="dv">131</span><span class="op">-</span>b11)</a>
<a class="sourceLine" id="cb82-11" data-line-number="11">Java <span class="kw">HotSpot</span>(TM) <span class="dv">64</span><span class="op">-</span>Bit Server <span class="kw">VM</span> (build <span class="fl">25.131</span><span class="op">-</span>b11, mixed mode)</a>
<a class="sourceLine" id="cb82-12" data-line-number="12"></a>
<a class="sourceLine" id="cb82-13" data-line-number="13">Starting H2O JVM and connecting<span class="op">:</span><span class="st"> </span>.. Connection successful<span class="op">!</span></a>
<a class="sourceLine" id="cb82-14" data-line-number="14"></a>
<a class="sourceLine" id="cb82-15" data-line-number="15">R is connected to the H2O cluster<span class="op">:</span><span class="st"> </span></a>
<a class="sourceLine" id="cb82-16" data-line-number="16"><span class="st">    </span>H2O cluster uptime<span class="op">:</span><span class="st">         </span><span class="dv">2</span> seconds <span class="dv">577</span> milliseconds </a>
<a class="sourceLine" id="cb82-17" data-line-number="17">    H2O cluster timezone<span class="op">:</span><span class="st">       </span>America<span class="op">/</span>New_York </a>
<a class="sourceLine" id="cb82-18" data-line-number="18">    H2O data parsing timezone<span class="op">:</span><span class="st">  </span>UTC </a>
<a class="sourceLine" id="cb82-19" data-line-number="19">    H2O cluster version<span class="op">:</span><span class="st">        </span><span class="dv">3</span>.<span class="dv">26</span>.<span class="fl">0.2</span> </a>
<a class="sourceLine" id="cb82-20" data-line-number="20">    H2O cluster version age<span class="op">:</span><span class="st">    </span><span class="dv">5</span> months and <span class="dv">5</span> days <span class="op">!!!</span><span class="st"> </span></a>
<a class="sourceLine" id="cb82-21" data-line-number="21"><span class="st">    </span>H2O cluster name<span class="op">:</span><span class="st">           </span>H2O_started_from_R_esteban_pgj795 </a>
<a class="sourceLine" id="cb82-22" data-line-number="22">    H2O cluster total nodes<span class="op">:</span><span class="st">    </span><span class="dv">1</span> </a>
<a class="sourceLine" id="cb82-23" data-line-number="23">    H2O cluster total memory<span class="op">:</span><span class="st">   </span><span class="fl">1.78</span> GB </a>
<a class="sourceLine" id="cb82-24" data-line-number="24">    H2O cluster total cores<span class="op">:</span><span class="st">    </span><span class="dv">4</span> </a>
<a class="sourceLine" id="cb82-25" data-line-number="25">    H2O cluster allowed cores<span class="op">:</span><span class="st">  </span><span class="dv">4</span> </a>
<a class="sourceLine" id="cb82-26" data-line-number="26">    H2O cluster healthy<span class="op">:</span><span class="st">        </span><span class="ot">TRUE</span> </a>
<a class="sourceLine" id="cb82-27" data-line-number="27">    H2O Connection ip<span class="op">:</span><span class="st">          </span>localhost </a>
<a class="sourceLine" id="cb82-28" data-line-number="28">    H2O Connection port<span class="op">:</span><span class="st">        </span><span class="dv">54321</span> </a>
<a class="sourceLine" id="cb82-29" data-line-number="29">    H2O Connection proxy<span class="op">:</span><span class="st">       </span><span class="ot">NA</span> </a>
<a class="sourceLine" id="cb82-30" data-line-number="30">    H2O Internal Security<span class="op">:</span><span class="st">      </span><span class="ot">FALSE</span> </a>
<a class="sourceLine" id="cb82-31" data-line-number="31">    H2O API Extensions<span class="op">:</span><span class="st">         </span>Amazon S3, XGBoost, Algos, AutoML, Core V3, Core V4 </a>
<a class="sourceLine" id="cb82-32" data-line-number="32">    R Version<span class="op">:</span><span class="st">                  </span>R version <span class="dv">3</span>.<span class="fl">5.3</span> (<span class="dv">2019-03-11</span>) </a>
<a class="sourceLine" id="cb82-33" data-line-number="33"></a>
<a class="sourceLine" id="cb82-34" data-line-number="34">Your H2O cluster version is too <span class="kw">old</span> (<span class="dv">5</span> months and <span class="dv">5</span> days)<span class="op">!</span></a>
<a class="sourceLine" id="cb82-35" data-line-number="35">Please download and install the latest version from http<span class="op">:</span><span class="er">//</span>h2o.ai<span class="op">/</span>download<span class="op">/</span></a>
<a class="sourceLine" id="cb82-36" data-line-number="36">Show <span class="cf">in</span> New WindowClear OutputExpand<span class="op">/</span>Collapse Output</a>
<a class="sourceLine" id="cb82-37" data-line-number="37">  <span class="op">|</span><span class="er">===========================================================|</span><span class="st"> </span><span class="dv">100</span>%</a>
<a class="sourceLine" id="cb82-38" data-line-number="38">Console<span class="op">~</span><span class="er">/</span>Dropbox<span class="op">/</span>ML<span class="op">/</span>bookdown<span class="op">-</span>minimal<span class="op">/</span></a>
<a class="sourceLine" id="cb82-39" data-line-number="39">Console</a>
<a class="sourceLine" id="cb82-40" data-line-number="40">Terminal</a>
<a class="sourceLine" id="cb82-41" data-line-number="41"></a>
<a class="sourceLine" id="cb82-42" data-line-number="42">R Markdown</a>
<a class="sourceLine" id="cb82-43" data-line-number="43"></a>
<a class="sourceLine" id="cb82-44" data-line-number="44"><span class="op">~</span><span class="er">/</span>Dropbox<span class="op">/</span>ML<span class="op">/</span>bookdown<span class="op">-</span>minimal<span class="op">/</span><span class="st">  </span></a></code></pre></div>
<p>Once the h2o environment has been initialized then work can begin. This will take the form of using R functions provided by the h2o package to read in data and prepare it for use with various methods. Let’s repeat the regression on mtcars using h2o functions. Since mtcars is already available in the the R environment we can easily import it into h2o.</p>
<div class="sourceCode" id="cb83"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb83-1" data-line-number="1"><span class="co"># Import mtcars</span></a>
<a class="sourceLine" id="cb83-2" data-line-number="2">mtcars_h2o_df &lt;-<span class="st"> </span><span class="kw">as.h2o</span>(mtcars)</a>
<a class="sourceLine" id="cb83-3" data-line-number="3"></a>
<a class="sourceLine" id="cb83-4" data-line-number="4"><span class="co"># Idenitfy the variable to be predicted</span></a>
<a class="sourceLine" id="cb83-5" data-line-number="5">y &lt;-<span class="st"> &quot;mpg&quot;</span></a>
<a class="sourceLine" id="cb83-6" data-line-number="6"></a>
<a class="sourceLine" id="cb83-7" data-line-number="7"><span class="co"># Put the predictor names into a vector</span></a>
<a class="sourceLine" id="cb83-8" data-line-number="8">x &lt;-<span class="st"> </span><span class="kw">setdiff</span>(<span class="kw">colnames</span>(mtcars_h2o_df),y)</a></code></pre></div>
</div>
<div id="create-some-models" class="section level2">
<h2><span class="header-section-number">8.2</span> Create Some Models</h2>
<p>Now let’s create some training and test data sets. We could do this ourselves using conventional R commands or helper functions from the caret package. However, the h2o package provides its own set of helpers.</p>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb84-1" data-line-number="1"><span class="kw">data</span>(mtcars)</a>
<a class="sourceLine" id="cb84-2" data-line-number="2">splits &lt;-<span class="st"> </span><span class="kw">h2o.splitFrame</span>(mtcars_h2o_df, <span class="dt">ratios=</span><span class="fl">0.8</span>,<span class="dt">seed=</span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb84-3" data-line-number="3">train_h2o &lt;-<span class="st"> </span>splits[[<span class="dv">1</span>]]</a>
<a class="sourceLine" id="cb84-4" data-line-number="4">test_h2o  &lt;-<span class="st"> </span>splits[[<span class="dv">2</span>]]</a>
<a class="sourceLine" id="cb84-5" data-line-number="5"></a>
<a class="sourceLine" id="cb84-6" data-line-number="6">train</a>
<a class="sourceLine" id="cb84-7" data-line-number="7"></a>
<a class="sourceLine" id="cb84-8" data-line-number="8">mpg cyl disp  hp drat    wt  qsec vs am gear carb</a>
<a class="sourceLine" id="cb84-9" data-line-number="9"><span class="dv">1</span> <span class="fl">21.0</span>   <span class="dv">6</span>  <span class="dv">160</span> <span class="dv">110</span> <span class="fl">3.90</span> <span class="fl">2.620</span> <span class="fl">16.46</span>  <span class="dv">0</span>  <span class="dv">1</span>    <span class="dv">4</span>    <span class="dv">4</span></a>
<a class="sourceLine" id="cb84-10" data-line-number="10"><span class="dv">2</span> <span class="fl">21.0</span>   <span class="dv">6</span>  <span class="dv">160</span> <span class="dv">110</span> <span class="fl">3.90</span> <span class="fl">2.875</span> <span class="fl">17.02</span>  <span class="dv">0</span>  <span class="dv">1</span>    <span class="dv">4</span>    <span class="dv">4</span></a>
<a class="sourceLine" id="cb84-11" data-line-number="11"><span class="dv">3</span> <span class="fl">21.4</span>   <span class="dv">6</span>  <span class="dv">258</span> <span class="dv">110</span> <span class="fl">3.08</span> <span class="fl">3.215</span> <span class="fl">19.44</span>  <span class="dv">1</span>  <span class="dv">0</span>    <span class="dv">3</span>    <span class="dv">1</span></a>
<a class="sourceLine" id="cb84-12" data-line-number="12"><span class="dv">4</span> <span class="fl">18.7</span>   <span class="dv">8</span>  <span class="dv">360</span> <span class="dv">175</span> <span class="fl">3.15</span> <span class="fl">3.440</span> <span class="fl">17.02</span>  <span class="dv">0</span>  <span class="dv">0</span>    <span class="dv">3</span>    <span class="dv">2</span></a>
<a class="sourceLine" id="cb84-13" data-line-number="13"><span class="dv">5</span> <span class="fl">18.1</span>   <span class="dv">6</span>  <span class="dv">225</span> <span class="dv">105</span> <span class="fl">2.76</span> <span class="fl">3.460</span> <span class="fl">20.22</span>  <span class="dv">1</span>  <span class="dv">0</span>    <span class="dv">3</span>    <span class="dv">1</span></a>
<a class="sourceLine" id="cb84-14" data-line-number="14"><span class="dv">6</span> <span class="fl">14.3</span>   <span class="dv">8</span>  <span class="dv">360</span> <span class="dv">245</span> <span class="fl">3.21</span> <span class="fl">3.570</span> <span class="fl">15.84</span>  <span class="dv">0</span>  <span class="dv">0</span>    <span class="dv">3</span>    <span class="dv">4</span></a>
<a class="sourceLine" id="cb84-15" data-line-number="15"></a>
<a class="sourceLine" id="cb84-16" data-line-number="16">[<span class="dv">29</span> rows x <span class="dv">11</span> columns] </a></code></pre></div>
<p>Now let’s create a model. We’ll use the Generalized Linear Model function from h2o. It is important to note that this function is implemented from within h2o. That is, we are not in anyway using any existing R packages to do this nor are we using anything from the care package. Here we’ll request a 4-Fold, Cross Validation step as part of the model assembly.</p>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb85-1" data-line-number="1">h2o_glm_model &lt;-<span class="st"> </span><span class="kw">h2o.glm</span>(<span class="dt">y=</span>y,<span class="dt">x=</span>x,train_h2o,<span class="dt">nfolds=</span><span class="dv">4</span>)</a>
<a class="sourceLine" id="cb85-2" data-line-number="2"><span class="kw">summary</span>(h2o_glm_model)</a>
<a class="sourceLine" id="cb85-3" data-line-number="3"></a>
<a class="sourceLine" id="cb85-4" data-line-number="4"><span class="co">#</span></a>
<a class="sourceLine" id="cb85-5" data-line-number="5"></a>
<a class="sourceLine" id="cb85-6" data-line-number="6"> <span class="op">|</span><span class="er">===========================================================|</span><span class="st"> </span><span class="dv">100</span>%</a>
<a class="sourceLine" id="cb85-7" data-line-number="7">Model Details<span class="op">:</span></a>
<a class="sourceLine" id="cb85-8" data-line-number="8"><span class="er">==============</span></a>
<a class="sourceLine" id="cb85-9" data-line-number="9"></a>
<a class="sourceLine" id="cb85-10" data-line-number="10">H2ORegressionModel<span class="op">:</span><span class="st"> </span>glm</a>
<a class="sourceLine" id="cb85-11" data-line-number="11">Model Key<span class="op">:</span><span class="st">  </span>GLM_model_R_<span class="dv">1577927955348</span>_<span class="dv">1</span> </a>
<a class="sourceLine" id="cb85-12" data-line-number="12">GLM Model<span class="op">:</span><span class="st"> </span>summary</a>
<a class="sourceLine" id="cb85-13" data-line-number="13">    family     link                              regularization</a>
<a class="sourceLine" id="cb85-14" data-line-number="14"><span class="dv">1</span> gaussian identity Elastic <span class="kw">Net</span> (<span class="dt">alpha =</span> <span class="fl">0.5</span>, <span class="dt">lambda =</span> <span class="fl">1.0664</span> )</a>
<a class="sourceLine" id="cb85-15" data-line-number="15">  number_of_predictors_total number_of_active_predictors</a>
<a class="sourceLine" id="cb85-16" data-line-number="16"><span class="dv">1</span>                         <span class="dv">10</span>                           <span class="dv">9</span></a>
<a class="sourceLine" id="cb85-17" data-line-number="17">  number_of_iterations    training_frame</a>
<a class="sourceLine" id="cb85-18" data-line-number="18"><span class="dv">1</span>                    <span class="dv">1</span> RTMP_sid_bf87_<span class="dv">673</span></a>
<a class="sourceLine" id="cb85-19" data-line-number="19"></a>
<a class="sourceLine" id="cb85-20" data-line-number="20">H2ORegressionMetrics<span class="op">:</span><span class="st"> </span>glm</a>
<a class="sourceLine" id="cb85-21" data-line-number="21"><span class="op">**</span><span class="st"> </span>Reported on training data. <span class="op">**</span></a>
<a class="sourceLine" id="cb85-22" data-line-number="22"></a>
<a class="sourceLine" id="cb85-23" data-line-number="23">MSE<span class="op">:</span><span class="st">  </span><span class="fl">6.185253</span></a>
<a class="sourceLine" id="cb85-24" data-line-number="24">RMSE<span class="op">:</span><span class="st">  </span><span class="fl">2.487017</span></a>
<a class="sourceLine" id="cb85-25" data-line-number="25">MAE<span class="op">:</span><span class="st">  </span><span class="fl">1.940791</span></a>
<a class="sourceLine" id="cb85-26" data-line-number="26">RMSLE<span class="op">:</span><span class="st">  </span><span class="fl">0.1135999</span></a>
<a class="sourceLine" id="cb85-27" data-line-number="27">Mean Residual Deviance <span class="op">:</span><span class="st">  </span><span class="fl">6.185253</span></a>
<a class="sourceLine" id="cb85-28" data-line-number="28">R<span class="op">^</span><span class="dv">2</span> <span class="op">:</span><span class="st">  </span><span class="fl">0.8392098</span></a>
<a class="sourceLine" id="cb85-29" data-line-number="29">Null Deviance <span class="op">:</span><span class="fl">1115.568</span></a>
<a class="sourceLine" id="cb85-30" data-line-number="30">Null D.o.F. <span class="op">:</span><span class="dv">28</span></a>
<a class="sourceLine" id="cb85-31" data-line-number="31">Residual Deviance <span class="op">:</span><span class="fl">179.3723</span></a>
<a class="sourceLine" id="cb85-32" data-line-number="32">Residual D.o.F. <span class="op">:</span><span class="dv">19</span></a>
<a class="sourceLine" id="cb85-33" data-line-number="33">AIC <span class="op">:</span><span class="fl">157.1413</span></a>
<a class="sourceLine" id="cb85-34" data-line-number="34"></a>
<a class="sourceLine" id="cb85-35" data-line-number="35"></a>
<a class="sourceLine" id="cb85-36" data-line-number="36"></a>
<a class="sourceLine" id="cb85-37" data-line-number="37">H2ORegressionMetrics<span class="op">:</span><span class="st"> </span>glm</a>
<a class="sourceLine" id="cb85-38" data-line-number="38"><span class="op">**</span><span class="st"> </span>Reported on cross<span class="op">-</span>validation data. <span class="op">**</span></a>
<a class="sourceLine" id="cb85-39" data-line-number="39"><span class="er">**</span><span class="st"> </span><span class="dv">4</span><span class="op">-</span>fold cross<span class="op">-</span>validation on training <span class="kw">data</span> (Metrics computed <span class="cf">for</span> combined holdout predictions) <span class="op">**</span></a>
<a class="sourceLine" id="cb85-40" data-line-number="40"></a>
<a class="sourceLine" id="cb85-41" data-line-number="41">MSE<span class="op">:</span><span class="st">  </span><span class="fl">9.520966</span></a>
<a class="sourceLine" id="cb85-42" data-line-number="42">RMSE<span class="op">:</span><span class="st">  </span><span class="fl">3.085606</span></a>
<a class="sourceLine" id="cb85-43" data-line-number="43">MAE<span class="op">:</span><span class="st">  </span><span class="fl">2.478209</span></a>
<a class="sourceLine" id="cb85-44" data-line-number="44">RMSLE<span class="op">:</span><span class="st">  </span><span class="fl">0.1462186</span></a>
<a class="sourceLine" id="cb85-45" data-line-number="45">Mean Residual Deviance <span class="op">:</span><span class="st">  </span><span class="fl">9.520966</span></a>
<a class="sourceLine" id="cb85-46" data-line-number="46">R<span class="op">^</span><span class="dv">2</span> <span class="op">:</span><span class="st">  </span><span class="fl">0.7524955</span></a>
<a class="sourceLine" id="cb85-47" data-line-number="47">Null Deviance <span class="op">:</span><span class="fl">1194.241</span></a>
<a class="sourceLine" id="cb85-48" data-line-number="48">Null D.o.F. <span class="op">:</span><span class="dv">28</span></a>
<a class="sourceLine" id="cb85-49" data-line-number="49">Residual Deviance <span class="op">:</span><span class="fl">276.108</span></a>
<a class="sourceLine" id="cb85-50" data-line-number="50">Residual D.o.F. <span class="op">:</span><span class="dv">19</span></a>
<a class="sourceLine" id="cb85-51" data-line-number="51">AIC <span class="op">:</span><span class="fl">169.6498</span></a>
<a class="sourceLine" id="cb85-52" data-line-number="52"></a>
<a class="sourceLine" id="cb85-53" data-line-number="53"></a>
<a class="sourceLine" id="cb85-54" data-line-number="54">Cross<span class="op">-</span>Validation Metrics Summary<span class="op">:</span><span class="st"> </span></a>
<a class="sourceLine" id="cb85-55" data-line-number="55"><span class="st">                            </span>mean          sd cv_<span class="dv">1</span>_valid cv_<span class="dv">2</span>_valid</a>
<a class="sourceLine" id="cb85-56" data-line-number="56">mae                    <span class="fl">2.4294133</span>   <span class="fl">0.4533141</span>  <span class="fl">3.3255308</span>  <span class="fl">2.6851656</span></a>
<a class="sourceLine" id="cb85-57" data-line-number="57">mean_residual_deviance  <span class="fl">9.431254</span>   <span class="fl">2.5729601</span>  <span class="fl">11.924386</span>  <span class="fl">13.098149</span></a>
<a class="sourceLine" id="cb85-58" data-line-number="58">mse                     <span class="fl">9.431254</span>   <span class="fl">2.5729601</span>  <span class="fl">11.924386</span>  <span class="fl">13.098149</span></a>
<a class="sourceLine" id="cb85-59" data-line-number="59">null_deviance          <span class="fl">298.56015</span>    <span class="fl">73.43793</span>   <span class="fl">429.7452</span>  <span class="fl">322.68143</span></a>
<a class="sourceLine" id="cb85-60" data-line-number="60">r2                     <span class="fl">0.7409388</span> <span class="fl">0.041704282</span>  <span class="fl">0.6850852</span> <span class="fl">0.70873845</span></a>
<a class="sourceLine" id="cb85-61" data-line-number="61">residual_deviance         <span class="fl">69.027</span>   <span class="fl">21.894964</span>  <span class="fl">107.31948</span>  <span class="fl">65.490746</span></a>
<a class="sourceLine" id="cb85-62" data-line-number="62">rmse                   <span class="fl">2.9984744</span>  <span class="fl">0.46925735</span>  <span class="fl">3.4531705</span>  <span class="fl">3.6191366</span></a>
<a class="sourceLine" id="cb85-63" data-line-number="63">rmsle                  <span class="fl">0.1363086</span> <span class="fl">0.026307607</span> <span class="fl">0.19733523</span> <span class="fl">0.13199924</span></a>
<a class="sourceLine" id="cb85-64" data-line-number="64">                       cv_<span class="dv">3</span>_valid cv_<span class="dv">4</span>_valid</a>
<a class="sourceLine" id="cb85-65" data-line-number="65">mae                     <span class="fl">1.6167169</span>  <span class="fl">2.0902402</span></a>
<a class="sourceLine" id="cb85-66" data-line-number="66">mean_residual_deviance  <span class="fl">3.6748443</span>   <span class="fl">9.027636</span></a>
<a class="sourceLine" id="cb85-67" data-line-number="67">mse                     <span class="fl">3.6748443</span>   <span class="fl">9.027636</span></a>
<a class="sourceLine" id="cb85-68" data-line-number="68">null_deviance           <span class="fl">139.37894</span>  <span class="fl">302.43506</span></a>
<a class="sourceLine" id="cb85-69" data-line-number="69">r2                     <span class="fl">0.83919096</span> <span class="fl">0.73074067</span></a>
<a class="sourceLine" id="cb85-70" data-line-number="70">residual_deviance       <span class="fl">22.049067</span>   <span class="fl">81.24872</span></a>
<a class="sourceLine" id="cb85-71" data-line-number="71">rmse                    <span class="fl">1.9169884</span>  <span class="fl">3.0046024</span></a>
<a class="sourceLine" id="cb85-72" data-line-number="72">rmsle                   <span class="fl">0.0983199</span> <span class="fl">0.11758001</span></a>
<a class="sourceLine" id="cb85-73" data-line-number="73"></a>
<a class="sourceLine" id="cb85-74" data-line-number="74">Scoring History<span class="op">:</span><span class="st"> </span></a>
<a class="sourceLine" id="cb85-75" data-line-number="75"><span class="st">            </span>timestamp   duration iterations negative_log_likelihood</a>
<a class="sourceLine" id="cb85-76" data-line-number="76"><span class="dv">1</span> <span class="dv">2020-01-01</span> <span class="dv">20</span><span class="op">:</span><span class="dv">21</span><span class="op">:</span><span class="dv">13</span>  <span class="fl">0.000</span> sec          <span class="dv">0</span>              <span class="fl">1115.56759</span></a>
<a class="sourceLine" id="cb85-77" data-line-number="77">  objective</a>
<a class="sourceLine" id="cb85-78" data-line-number="78"><span class="dv">1</span>  <span class="fl">38.46785</span></a>
<a class="sourceLine" id="cb85-79" data-line-number="79"></a>
<a class="sourceLine" id="cb85-80" data-line-number="80">Variable Importances<span class="op">:</span><span class="st"> </span>(Extract with <span class="st">`</span><span class="dt">h2o.varimp</span><span class="st">`</span>) </a>
<a class="sourceLine" id="cb85-81" data-line-number="81"><span class="op">==</span><span class="er">===============================================</span></a>
<a class="sourceLine" id="cb85-82" data-line-number="82"></a>
<a class="sourceLine" id="cb85-83" data-line-number="83"><span class="st">   </span>variable relative_importance scaled_importance  percentage</a>
<a class="sourceLine" id="cb85-84" data-line-number="84"><span class="dv">1</span>        wt          <span class="fl">1.19294625</span>        <span class="fl">1.00000000</span> <span class="fl">0.208632891</span></a>
<a class="sourceLine" id="cb85-85" data-line-number="85"><span class="dv">2</span>       cyl          <span class="fl">0.92951526</span>        <span class="fl">0.77917615</span> <span class="fl">0.162561772</span></a>
<a class="sourceLine" id="cb85-86" data-line-number="86"><span class="dv">3</span>      disp          <span class="fl">0.78424629</span>        <span class="fl">0.65740287</span> <span class="fl">0.137155861</span></a>
<a class="sourceLine" id="cb85-87" data-line-number="87"><span class="dv">4</span>        hp          <span class="fl">0.69294345</span>        <span class="fl">0.58086729</span> <span class="fl">0.121188021</span></a>
<a class="sourceLine" id="cb85-88" data-line-number="88"><span class="dv">5</span>      carb          <span class="fl">0.62287613</span>        <span class="fl">0.52213261</span> <span class="fl">0.108934035</span></a>
<a class="sourceLine" id="cb85-89" data-line-number="89"><span class="dv">6</span>        am          <span class="fl">0.55736672</span>        <span class="fl">0.46721864</span> <span class="fl">0.097477175</span></a>
<a class="sourceLine" id="cb85-90" data-line-number="90"><span class="dv">7</span>        vs          <span class="fl">0.46246830</span>        <span class="fl">0.38766902</span> <span class="fl">0.080880507</span></a>
<a class="sourceLine" id="cb85-91" data-line-number="91"><span class="dv">8</span>      drat          <span class="fl">0.45447201</span>        <span class="fl">0.38096604</span> <span class="fl">0.079482047</span></a>
<a class="sourceLine" id="cb85-92" data-line-number="92"><span class="dv">9</span>      gear          <span class="fl">0.02108593</span>        <span class="fl">0.01767551</span> <span class="fl">0.003687692</span></a>
<a class="sourceLine" id="cb85-93" data-line-number="93"><span class="dv">10</span>     qsec          <span class="fl">0.00000000</span>        <span class="fl">0.00000000</span> <span class="fl">0.000000000</span></a></code></pre></div>
<p>Now we can do a prediction on the object against the test set.</p>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb86-1" data-line-number="1">(h2o_glm_preds &lt;-<span class="st"> </span><span class="kw">h2o.predict</span>(h2o_glm_model,test_h2o))</a>
<a class="sourceLine" id="cb86-2" data-line-number="2"></a>
<a class="sourceLine" id="cb86-3" data-line-number="3"><span class="co">#</span></a>
<a class="sourceLine" id="cb86-4" data-line-number="4"><span class="kw">h2o.performance</span>(h2o_glm_model,test_h2o)</a>
<a class="sourceLine" id="cb86-5" data-line-number="5"></a>
<a class="sourceLine" id="cb86-6" data-line-number="6"> <span class="op">|</span><span class="er">===========================================================|</span><span class="st"> </span><span class="dv">100</span>%</a>
<a class="sourceLine" id="cb86-7" data-line-number="7">   predict</a>
<a class="sourceLine" id="cb86-8" data-line-number="8"><span class="dv">1</span> <span class="fl">25.93186</span></a>
<a class="sourceLine" id="cb86-9" data-line-number="9"><span class="dv">2</span> <span class="fl">20.67344</span></a>
<a class="sourceLine" id="cb86-10" data-line-number="10"><span class="dv">3</span> <span class="fl">24.38237</span></a>
<a class="sourceLine" id="cb86-11" data-line-number="11"></a>
<a class="sourceLine" id="cb86-12" data-line-number="12">[<span class="dv">3</span> rows x <span class="dv">1</span> column] </a>
<a class="sourceLine" id="cb86-13" data-line-number="13">H2ORegressionMetrics<span class="op">:</span><span class="st"> </span>glm</a>
<a class="sourceLine" id="cb86-14" data-line-number="14"></a>
<a class="sourceLine" id="cb86-15" data-line-number="15">MSE<span class="op">:</span><span class="st">  </span><span class="fl">6.762548</span></a>
<a class="sourceLine" id="cb86-16" data-line-number="16">RMSE<span class="op">:</span><span class="st">  </span><span class="fl">2.60049</span></a>
<a class="sourceLine" id="cb86-17" data-line-number="17">MAE<span class="op">:</span><span class="st">  </span><span class="fl">2.495891</span></a>
<a class="sourceLine" id="cb86-18" data-line-number="18">RMSLE<span class="op">:</span><span class="st">  </span><span class="fl">0.1076563</span></a>
<a class="sourceLine" id="cb86-19" data-line-number="19">Mean Residual Deviance <span class="op">:</span><span class="st">  </span><span class="fl">6.762548</span></a>
<a class="sourceLine" id="cb86-20" data-line-number="20">R<span class="op">^</span><span class="dv">2</span> <span class="op">:</span><span class="st">  </span><span class="fl">-2.052306</span></a>
<a class="sourceLine" id="cb86-21" data-line-number="21">Null Deviance <span class="op">:</span><span class="fl">10.87611</span></a>
<a class="sourceLine" id="cb86-22" data-line-number="22">Null D.o.F. <span class="op">:</span><span class="dv">2</span></a>
<a class="sourceLine" id="cb86-23" data-line-number="23">Residual Deviance <span class="op">:</span><span class="fl">20.28765</span></a>
<a class="sourceLine" id="cb86-24" data-line-number="24">Residual D.o.F. <span class="op">:-</span><span class="dv">7</span></a>
<a class="sourceLine" id="cb86-25" data-line-number="25">AIC <span class="op">:</span><span class="fl">36.24783</span></a></code></pre></div>
<p>Now look at the performance diagnostics:</p>
<div class="sourceCode" id="cb87"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb87-1" data-line-number="1"><span class="kw">h2o.performance</span>(h2o_glm_model,test_h2o)</a>
<a class="sourceLine" id="cb87-2" data-line-number="2"></a>
<a class="sourceLine" id="cb87-3" data-line-number="3">H2ORegressionMetrics<span class="op">:</span><span class="st"> </span>glm</a>
<a class="sourceLine" id="cb87-4" data-line-number="4"></a>
<a class="sourceLine" id="cb87-5" data-line-number="5">MSE<span class="op">:</span><span class="st">  </span><span class="fl">6.762548</span></a>
<a class="sourceLine" id="cb87-6" data-line-number="6">RMSE<span class="op">:</span><span class="st">  </span><span class="fl">2.60049</span></a>
<a class="sourceLine" id="cb87-7" data-line-number="7">MAE<span class="op">:</span><span class="st">  </span><span class="fl">2.495891</span></a>
<a class="sourceLine" id="cb87-8" data-line-number="8">RMSLE<span class="op">:</span><span class="st">  </span><span class="fl">0.1076563</span></a>
<a class="sourceLine" id="cb87-9" data-line-number="9">Mean Residual Deviance <span class="op">:</span><span class="st">  </span><span class="fl">6.762548</span></a>
<a class="sourceLine" id="cb87-10" data-line-number="10">R<span class="op">^</span><span class="dv">2</span> <span class="op">:</span><span class="st">  </span><span class="fl">-2.052306</span></a>
<a class="sourceLine" id="cb87-11" data-line-number="11">Null Deviance <span class="op">:</span><span class="fl">10.87611</span></a>
<a class="sourceLine" id="cb87-12" data-line-number="12">Null D.o.F. <span class="op">:</span><span class="dv">2</span></a>
<a class="sourceLine" id="cb87-13" data-line-number="13">Residual Deviance <span class="op">:</span><span class="fl">20.28765</span></a>
<a class="sourceLine" id="cb87-14" data-line-number="14">Residual D.o.F. <span class="op">:-</span><span class="dv">7</span></a>
<a class="sourceLine" id="cb87-15" data-line-number="15">AIC <span class="op">:</span><span class="fl">36.24783</span></a></code></pre></div>
</div>
<div id="saving-a-model" class="section level2">
<h2><span class="header-section-number">8.3</span> Saving A Model</h2>
<p>You can save the contents of any h2o generated model by using the h2o.saveModel() function. You could extract pieces of information from the S4 object but saving the model is easy to do - as is reading it back in.</p>
<div class="sourceCode" id="cb88"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb88-1" data-line-number="1">model_path &lt;-<span class="st"> </span><span class="kw">h2o.saveModel</span>(h2o_glm_model,<span class="dt">path=</span><span class="kw">getwd</span>(),<span class="dt">force=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb88-2" data-line-number="2"></a>
<a class="sourceLine" id="cb88-3" data-line-number="3"><span class="co"># If you need to load a previously saved model</span></a>
<a class="sourceLine" id="cb88-4" data-line-number="4"></a>
<a class="sourceLine" id="cb88-5" data-line-number="5">saved_model &lt;-<span class="st"> </span><span class="kw">h2o.loadModel</span>(model_path)</a></code></pre></div>
</div>
<div id="using-the-auto-ml-feature" class="section level2">
<h2><span class="header-section-number">8.4</span> Using the Auto ML Feature</h2>
<p>Are you curious as to what model might be the “best” for your data ? This is a very fertile field of research that keeps growing and some feel will one be the dominant technology in ML - where a model picks a model. Sounds odd but that is where it is heading. Check the current h2o Auto ML documentation for more details. For now, most of the Auto ML services use a set of heuristics to examine data and then find the most appropriate method to build a model. The currently supported method implementations in the opensource version include:</p>
<pre><code>- three pre-specified XGBoost GBM (Gradient Boosting Machine) models
- a fixed grid of GLMs, a default Random Forest (DRF)
- five pre-specified H2O GBMs
- a near-default Deep Neural Net
- an Extremely Randomized Forest (XRT)
- a random grid of XGBoost GBMs
- a random grid of H2O GBMs
- a random grid of Deep Neural Nets.</code></pre>
</div>
<div id="launching-a-job" class="section level2">
<h2><span class="header-section-number">8.5</span> Launching A Job</h2>
<p>Of course, it all begins with the idea of specifying a performance metric such as RMSE or the area under a ROC curve. The idea here is that we specify some input, apply transformations, create a test/train pair, and then call the h2o auto function.</p>
<div class="sourceCode" id="cb90"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb90-1" data-line-number="1">h2o_auto_mtcars &lt;-<span class="st"> </span><span class="kw">h2o.automl</span>(<span class="dt">y =</span> y, <span class="dt">x =</span> x,</a>
<a class="sourceLine" id="cb90-2" data-line-number="2">                              <span class="dt">training_frame =</span> train_h2o,</a>
<a class="sourceLine" id="cb90-3" data-line-number="3">                              <span class="dt">leaderboard_frame =</span> test_h2o,</a>
<a class="sourceLine" id="cb90-4" data-line-number="4">                              <span class="dt">max_runtime_secs =</span> <span class="dv">60</span>,</a>
<a class="sourceLine" id="cb90-5" data-line-number="5">                              <span class="dt">seed =</span> <span class="dv">1</span>,</a>
<a class="sourceLine" id="cb90-6" data-line-number="6">                              <span class="dt">sort_metric =</span> <span class="st">&quot;RMSE&quot;</span>,</a>
<a class="sourceLine" id="cb90-7" data-line-number="7">                              <span class="dt">project_name =</span> <span class="st">&quot;mtcars&quot;</span>)</a></code></pre></div>
<p>Let’s check out the object that is returned. It is an S4 object in R which means that it has “slots” which can be accessed via the “@” operator.</p>
<div class="sourceCode" id="cb91"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb91-1" data-line-number="1"><span class="kw">slotNames</span>(h2o_auto_mtcars)</a>
<a class="sourceLine" id="cb91-2" data-line-number="2">h2o_auto_mtcars<span class="op">@</span>leaderboard</a>
<a class="sourceLine" id="cb91-3" data-line-number="3"></a>
<a class="sourceLine" id="cb91-4" data-line-number="4">[<span class="dv">1</span>] <span class="st">&quot;project_name&quot;</span>  <span class="st">&quot;leader&quot;</span>        <span class="st">&quot;leaderboard&quot;</span>   <span class="st">&quot;event_log&quot;</span>    </a>
<a class="sourceLine" id="cb91-5" data-line-number="5">[<span class="dv">5</span>] <span class="st">&quot;training_info&quot;</span></a>
<a class="sourceLine" id="cb91-6" data-line-number="6">                                        model_id</a>
<a class="sourceLine" id="cb91-7" data-line-number="7"><span class="dv">1</span>     GBM_grid_<span class="dv">1</span>_AutoML_<span class="dv">20200101</span>_<span class="dv">202413</span>_model_<span class="dv">53</span></a>
<a class="sourceLine" id="cb91-8" data-line-number="8"><span class="dv">2</span>          DeepLearning_<span class="dv">1</span>_AutoML_<span class="dv">20200101</span>_<span class="dv">202413</span></a>
<a class="sourceLine" id="cb91-9" data-line-number="9"><span class="dv">3</span> XGBoost_grid_<span class="dv">1</span>_AutoML_<span class="dv">20200101</span>_<span class="dv">202413</span>_model_<span class="dv">14</span></a>
<a class="sourceLine" id="cb91-10" data-line-number="10"><span class="dv">4</span>  XGBoost_grid_<span class="dv">1</span>_AutoML_<span class="dv">20200101</span>_<span class="dv">202413</span>_model_<span class="dv">5</span></a>
<a class="sourceLine" id="cb91-11" data-line-number="11"><span class="dv">5</span>     GBM_grid_<span class="dv">1</span>_AutoML_<span class="dv">20200101</span>_<span class="dv">202413</span>_model_<span class="dv">52</span></a>
<a class="sourceLine" id="cb91-12" data-line-number="12"><span class="dv">6</span>     GBM_grid_<span class="dv">1</span>_AutoML_<span class="dv">20200101</span>_<span class="dv">202413</span>_model_<span class="dv">16</span></a>
<a class="sourceLine" id="cb91-13" data-line-number="13">  mean_residual_deviance      rmse       mse       mae      rmsle</a>
<a class="sourceLine" id="cb91-14" data-line-number="14"><span class="dv">1</span>              <span class="fl">0.2147231</span> <span class="fl">0.4633822</span> <span class="fl">0.2147231</span> <span class="fl">0.4138704</span> <span class="fl">0.02128094</span></a>
<a class="sourceLine" id="cb91-15" data-line-number="15"><span class="dv">2</span>              <span class="fl">0.3734735</span> <span class="fl">0.6111248</span> <span class="fl">0.3734735</span> <span class="fl">0.5076945</span> <span class="fl">0.02559229</span></a>
<a class="sourceLine" id="cb91-16" data-line-number="16"><span class="dv">3</span>              <span class="fl">0.4586288</span> <span class="fl">0.6772213</span> <span class="fl">0.4586288</span> <span class="fl">0.6318582</span> <span class="fl">0.03060372</span></a>
<a class="sourceLine" id="cb91-17" data-line-number="17"><span class="dv">4</span>              <span class="fl">0.4787276</span> <span class="fl">0.6919014</span> <span class="fl">0.4787276</span> <span class="fl">0.5760670</span> <span class="fl">0.03091116</span></a>
<a class="sourceLine" id="cb91-18" data-line-number="18"><span class="dv">5</span>              <span class="fl">0.7571985</span> <span class="fl">0.8701716</span> <span class="fl">0.7571985</span> <span class="fl">0.7831136</span> <span class="fl">0.03729489</span></a>
<a class="sourceLine" id="cb91-19" data-line-number="19"><span class="dv">6</span>              <span class="fl">0.7772694</span> <span class="fl">0.8816289</span> <span class="fl">0.7772694</span> <span class="fl">0.8020415</span> <span class="fl">0.03896093</span></a>
<a class="sourceLine" id="cb91-20" data-line-number="20"></a>
<a class="sourceLine" id="cb91-21" data-line-number="21">[<span class="dv">89</span> rows x <span class="dv">6</span> columns] </a></code></pre></div>
<p>Stop the H2O instance</p>
<div class="sourceCode" id="cb92"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb92-1" data-line-number="1"><span class="kw">h2o.shutdown</span>(<span class="dt">prompt=</span><span class="ot">FALSE</span>)</a></code></pre></div>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="comparing-models.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["SEMINAR_SERIES.pdf", "SEMINAR_SERIES.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
